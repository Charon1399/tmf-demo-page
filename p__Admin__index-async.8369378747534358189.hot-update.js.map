{"version":3,"sources":["p__Admin__index-async.8369378747534358189.hot-update.js","src/pages/Admin/ResourceAgent/index.tsx"],"sourcesContent":["globalThis.makoModuleHotUpdate(\r\n  'p__Admin__index',\r\n  {\r\n    modules: {},\r\n  },\r\n  function (runtime) {\r\n    runtime._h='14252025568755006481';\nruntime.updateEnsure2Map({\"node_modules/react-dom/client.js\":[\"node_modules/react-dom/client.js\"],\"src/.umi/core/EmptyRoute.tsx\":[\"src/.umi/core/EmptyRoute.tsx\"],\"src/.umi/plugin-layout/Layout.tsx\":[\"vendors_5\",\"vendors_2\",\"vendors_3\",\"vendors_4\",\"src/.umi/plugin-layout/Layout.tsx\"],\"src/.umi/plugin-openapi/openapi.tsx\":[\"vendors_5\",\"vendors_0\",\"src/.umi/plugin-openapi/openapi.tsx\"],\"src/pages/404.tsx\":[\"p__404\"],\"src/pages/Admin/Fault/index.js\":[\"vendors_0\",\"vendors_1\",\"vendors_2\",\"vendors_3\",\"p__Admin__Fault__index\"],\"src/pages/Admin/hvac/index.js\":[\"vendors_0\",\"vendors_1\",\"vendors_2\",\"vendors_3\",\"p__Admin__hvac__index\"],\"src/pages/Admin/index.tsx\":[\"vendors_0\",\"vendors_1\",\"vendors_2\",\"vendors_3\",\"p__Admin__index\"],\"src/pages/User/Chat/index.tsx\":[\"p__User__Chat__index\"]});;\r\n  },\r\n);\r\n","import React, { useState, useEffect } from 'react';\r\nimport styles from './index.less';\r\nimport { RESOURCE_AGENT_STATUS_STORAGE_KEY, RESOURCE_AGENT_STATUS_TIMESTAMP_STORAGE_KEY, ResourceAgentStatus, Scenario, SCENARIO_STORAGE_KEY } from '@/contexts/constants';\r\nimport TaskDetail from './TaskDetail';\r\nimport { Tab } from './constant';\r\nimport TaskWorkflow from './TaskWorkflow';\r\nimport { Button, FloatButton, Table } from 'antd';\r\nimport { UserOutlined, CodeOutlined } from '@ant-design/icons';\r\nimport ResourceAgentLog from './ResourceAgentLog';\r\n\r\nconst ResourceAgent: React.FC<{ changeMenu: (menu: string, collapsed: boolean) => void }> = ({ changeMenu }) => {\r\n  const [readyStatus, setReadyStatus] = useState(() => {\r\n    const storedStatus = localStorage.getItem(RESOURCE_AGENT_STATUS_STORAGE_KEY);\r\n    return parseInt(storedStatus || ResourceAgentStatus.init.toString());\r\n  });\r\n  const [tab, setTab] = useState(Tab.TaskList);\r\n  const [showSourceLog, setShowSourceLog] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if ( (ResourceAgentStatus.bssPlanGenerated <= readyStatus && readyStatus < ResourceAgentStatus.resourceSolutionGenerated)  && tab === Tab.TaskList) {\r\n      setTimeout(() => {\r\n        setTab(Tab.TaskDetail);\r\n      }, 1000)\r\n    } else if (readyStatus === ResourceAgentStatus.resourceSolutionGenerated && tab === Tab.TaskDetail) {\r\n      // setTimeout(() => {\r\n      //   setTab(Tab.TaskList);\r\n      // }, 3000)\r\n    } else if (readyStatus === ResourceAgentStatus.taskStarted && tab === Tab.TaskList) {\r\n      setTimeout(() => {\r\n        setTab(Tab.TaskWorkflow);\r\n      }, 1000)\r\n    } else if (readyStatus === ResourceAgentStatus.taskCompleted && tab === Tab.TaskWorkflow) {\r\n      // setTimeout(() => {\r\n      //   setTab(Tab.TaskList);\r\n      // }, 3000)\r\n    } else if (readyStatus === ResourceAgentStatus.taskCompleted && tab === Tab.TaskList) {\r\n      if (localStorage.getItem(SCENARIO_STORAGE_KEY) === Scenario.orderReceived.toString()) {\r\n        localStorage.setItem(SCENARIO_STORAGE_KEY, Scenario.resourceCompleted.toString());\r\n        // setTimeout(() => {\r\n        //   changeMenu('agents-chat', false);\r\n        // }, 2000)\r\n      }\r\n    }\r\n  }, [readyStatus, tab]);\r\n\r\n  let statusTimestamps = new Map();\r\n  const statusTimestampsStr = localStorage.getItem(RESOURCE_AGENT_STATUS_TIMESTAMP_STORAGE_KEY);\r\n  if (statusTimestampsStr && statusTimestampsStr !== '[]') {\r\n    statusTimestamps = new Map(JSON.parse(statusTimestampsStr));\r\n  }\r\n\r\n  const tableData = [\r\n    {\r\n      key: 1,\r\n      no: 1,\r\n      taskId: new Date(statusTimestamps.get(ResourceAgentStatus.bssPlanGenerated.toString())).getTime(),\r\n      taskType: 'create',\r\n      productName: 'AI Medical Model Training',\r\n      taskStatus:\r\n        readyStatus < ResourceAgentStatus.resourceSolutionGenerated ?\r\n          <div className={styles.statusProcessing}>CREATING</div>\r\n          : readyStatus === ResourceAgentStatus.resourceSolutionGenerated\r\n            ? <div className={styles.statusNotStarted}>NOT STARTED</div>\r\n            : readyStatus < ResourceAgentStatus.taskCompleted\r\n              ? <div className={styles.statusProcessing}>PROCESSING</div>\r\n              : <div className={styles.statusCompleted}>COMPLETED</div>,\r\n      creationTime: statusTimestamps.get(ResourceAgentStatus.bssPlanGenerated.toString()) || '',\r\n      completionTime: statusTimestamps.get(ResourceAgentStatus.taskCompleted.toString()) || '',\r\n    },\r\n  ];\r\n  const actionColumn = () => {\r\n    return (\r\n      <>\r\n        <Button type=\"link\" onClick={() => setTab(Tab.TaskDetail)} className={styles.actionButton}>Detail</Button>\r\n        <Button\r\n          type=\"link\"\r\n          onClick={() => {\r\n            setReadyStatus(ResourceAgentStatus.taskStarted);\r\n            localStorage.setItem(RESOURCE_AGENT_STATUS_STORAGE_KEY, ResourceAgentStatus.taskStarted.toString());\r\n            let statusTimestamps = new Map();\r\n            const statusTimestampsStr = localStorage.getItem(RESOURCE_AGENT_STATUS_TIMESTAMP_STORAGE_KEY);\r\n            if (statusTimestampsStr && statusTimestampsStr !== '[]') {\r\n              statusTimestamps = new Map(JSON.parse(statusTimestampsStr));\r\n            }\r\n            statusTimestamps.set(ResourceAgentStatus.taskStarted.toString(), new Date().toLocaleString());\r\n            localStorage.setItem(RESOURCE_AGENT_STATUS_TIMESTAMP_STORAGE_KEY, JSON.stringify(Array.from(statusTimestamps.entries())));\r\n          }}\r\n          disabled={readyStatus !== ResourceAgentStatus.resourceSolutionGenerated}\r\n          className={styles.actionButton}\r\n        >\r\n          Start\r\n        </Button>\r\n        <Button\r\n          type=\"link\"\r\n          onClick={() => setTab(Tab.TaskWorkflow)}\r\n          disabled={readyStatus !== ResourceAgentStatus.taskStarted}\r\n          className={styles.actionButton}\r\n        >\r\n          Workflow\r\n        </Button>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {/* {showSourceLog ? (\r\n        <FloatButton style={{ right: 64, bottom: 64 }} icon={<UserOutlined />} onClick={() => setShowSourceLog(false)} />\r\n      ): (\r\n        <FloatButton style={{ right: 64, bottom: 64 }} icon={<CodeOutlined />} onClick={() => setShowSourceLog(true)} />\r\n      )} */}\r\n      <h1 className={styles.title}>Resource Agent</h1>\r\n      {showSourceLog && <ResourceAgentLog />}\r\n      {!showSourceLog && tab === Tab.TaskList && (\r\n        <>\r\n          <div className={styles.breadcrumb}>\r\n            <span>Task List</span>\r\n          </div>\r\n          <div className={styles.innerContainer}>\r\n            <Table className={styles.table} dataSource={readyStatus >= ResourceAgentStatus.bssPlanGenerated ? tableData : []}>\r\n              <Table.Column title=\"NO.\" dataIndex=\"no\" key=\"no\" />\r\n              <Table.Column title=\"Task ID\" dataIndex=\"taskId\" key=\"taskId\" />\r\n              <Table.Column title=\"Task Type\" dataIndex=\"taskType\" key=\"taskType\" />\r\n              <Table.Column title=\"Product Name\" dataIndex=\"productName\" key=\"productName\" />\r\n              <Table.Column title=\"Task Status\" dataIndex=\"taskStatus\" key=\"taskStatus\" />\r\n              <Table.Column title=\"Creation Time\" dataIndex=\"creationTime\" key=\"creationTime\" />\r\n              <Table.Column title=\"Completion Time\" dataIndex=\"completionTime\" key=\"completionTime\" />\r\n              <Table.Column title=\"Action\" key=\"action\" render={() => actionColumn()}\r\n              />\r\n            </Table>\r\n          </div>\r\n        </>\r\n      )}\r\n      {!showSourceLog && tab === Tab.TaskDetail && (\r\n        <>\r\n          <div className={styles.breadcrumb}>\r\n            <a onClick={() => setTab(Tab.TaskList)}>Task List</a>\r\n            <span> \\ Task Detail</span>\r\n          </div>\r\n          <div className={styles.innerContainer}>\r\n            <TaskDetail readyStatus={readyStatus} setReadyStatus={setReadyStatus} />\r\n          </div>\r\n        </>\r\n      )}\r\n      {!showSourceLog && tab === Tab.TaskWorkflow && (\r\n        <>\r\n          <div className={styles.breadcrumb}>\r\n            <a onClick={() => setTab(Tab.TaskList)}>Task List</a>\r\n            <span> \\ Workflow</span>\r\n          </div>\r\n          <div>\r\n            <TaskWorkflow readyStatus={readyStatus} setReadyStatus={setReadyStatus} />\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResourceAgent; "],"names":[],"mappings":"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"}